# YouTube Link Downloader Chrome Extension

## Overview
This repository contains a **Chrome extension** that adds a context‑menu entry to YouTube links, allowing you to download the video in high quality, low quality, or audio‑only format.  
The extension communicates with a **native messaging host** written in Python (`youtube_downloader.py`) which uses **yt‑dlp** to perform the actual download and sends a desktop notification when the download finishes.

_This project was fully generated by AI (aider + gpt-oss-120b)._

## Features
- Context‑menu items for:
  - High‑quality video (`720p` or best available)
  - Low‑quality video (`360p` or best available)
  - Audio‑only download
- Native messaging bridge between Chrome and a Python script.
- Automatic desktop notification (`notify-send`) after a successful download.
- Configurable download directories for videos and music.

## Prerequisites
1. **Google Chrome** (or any Chromium‑based browser that supports Manifest V3).  
2. **Python 3.8+** installed on the host machine.  
3. The following Python packages (install via `pip`):
   ```bash
   pip install yt-dlp
   ```
4. `notify-send` utility (usually available on most Linux desktop environments).  
 5. (Optional) A SOCKS5 proxy if you need to route traffic through one – the script is pre‑configured to use `socks://127.0.0.1:1080`.

## Installation

### 1. Install the Chrome extension
1. Open Chrome and go to `chrome://extensions/`.  
2. Enable **Developer mode** (toggle in the top‑right corner).  
3. Click **Load unpacked** and select the `add-on/` directory of this repository.  
   The extension will appear in the toolbar and its context‑menu entries will be available on YouTube links.

### 2. Set up the native messaging host
1. Make the Python script executable:
   ```bash
   chmod +x app/youtube_downloader.py
   ```
2. Ensure the JSON manifest (`app/youtube_downloader.json`) points to the correct absolute path of the script.  
   Adjust the `"path"` field if you moved the repository.
3. Copy the JSON file to Chrome’s native messaging directory (may require `sudo`):
   ```bash
   sudo mkdir -p /etc/opt/chrome/native-messaging-hosts
   sudo cp app/youtube_downloader.json /etc/opt/chrome/native-messaging-hosts/
   ```
   For Chromium use `/etc/chromium/native-messaging-hosts/` instead.
4. Verify the host is registered:
   ```bash
   cat /etc/opt/chrome/native-messaging-hosts/youtube_downloader.json
   ```

## Usage
1. Right‑click any YouTube link on a webpage.  
2. Choose **“Скачать видео в высоком качестве”**, **“Скачать видео в низком качестве”**, or **“Скачать как аудио”**.  
3. The extension sends a JSON message to the native host, which starts the download with `yt-dlp`.  
4. When the download finishes, a desktop notification appears with the file name.

## Testing
The repository includes a simple test script (`app/test.sh`) that sends a mock message to the native host:
```bash
cd app
./test.sh
```
Make sure the host is correctly installed before running the test.

## Troubleshooting
- **No notification‑send**: Install `libnotify-bin` (Debian/Ubuntu) or the equivalent for your distro.  
- **Permission errors**: Ensure the JSON manifest is placed in the correct system directory and has appropriate read permissions.  
- **Proxy issues**: Edit `youtube_downloader.py` and modify or remove the `"proxy"` option in `ydl_opts`.  
- **Logs**: All native host activity is logged to `/tmp/native_host.log`. Check this file for detailed error messages.

---  
